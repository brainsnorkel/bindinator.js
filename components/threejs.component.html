<!--
# three.js example

[threejs](https://threejs.org//) is a 3D engine created by Ricardo Cabello.

It loads via require() but sets a global rather than passing back to module.exports.
-->
<style>
  .threejs {
    position: fixed;
    top: 50%;
    left: 6px;
    width: 768px;
    height: 512px;
    transform: translateY(-50%);
    pointer-events: none;
    opacity: 0.8;
  }
</style>
<script>
/* global require, THREE, component */
'use strict';

  require.lazy('https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js').
  then(() => {
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera( 60, 1.5, 0.1, 1000 );
    const renderer = new THREE.WebGLRenderer({ alpha: true });

    renderer.setSize( 768, 512 );
    const canvas = renderer.domElement;
    canvas.classList.add('threejs');
    component.appendChild(canvas);


    const sunlight = new THREE.DirectionalLight(0xffffcc, 1);
    sunlight.position.set(100, 50, 50);
    scene.add(sunlight);
    const backlight = new THREE.DirectionalLight(0x8888ff, 0.25);
    backlight.position.set(-100, 50, 50);
    scene.add(backlight);

    const geometry = new THREE.BoxGeometry( 1, 1, 1 );
    const material = new THREE.MeshPhysicalMaterial( { color: 0xaaddaa, emissive: 0x404020 } );
    const cube = new THREE.Mesh( geometry, material );
    scene.add( cube );

    camera.position.z = 2;
    cube.rotation.x = 10;

    const update = () => {
      cube.rotation.y += 0.01;
    }

    function render() {
      if(canvas.closest('body')) {
        update();
        requestAnimationFrame( render );
        renderer.render( scene, camera );
      }
    }
    render();
  });
</script>
