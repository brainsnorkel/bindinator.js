<!--
# modal
Copyright Â©2016-2017 Tonio Loewald
-->
<style>
  .modal-dialog-backdrop {
    background-color: rgba(0,0,0,0.15);
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .modal-dialog {
    position: relative;
    padding: 12px;
    min-width: 400px;
    background-color: white;
    box-shadow: 1px 6px 12px 0 rgba(0,0,0,0.5);
  }

  .modal-dialog button {
    margin-left: 5px;
  }
</style>
<div class="modal-dialog-backdrop">
  <div
    class="modal-dialog"
    tabindex="0"
    data-event="
      click:_component_.button;
      keyup(Enter):_component_.default;
      keyup(Escape):_component_.cancel;
    "
  >
    <div data-children>
      <h3>Placeholder</h3>
      <p>Here is some text</p>
      <div style="text-align: right;">
        <button
          data-list="_component_.buttons"
          data-bind="
            text=.caption;
            class(default)=.default;
            class(cancel)=.cancel
          "
        >Button Name</button>
      </div>
    </div>
  </div>
</div>
<script>
/* global data, findOne, component, set, b8r */
'use strict';
  const dialog = findOne('.modal-dialog');

  if (data.className) {
    dialog.classList.remove('modal-dialog');
    dialog.classList.add(data.className);
  }

  dialog.focus();

  if (!data.buttons) {
    set('buttons', [{
      caption: 'Cancel',
      cancel: true
    },
    {
      caption: 'OK',
      default: true
    }]);
  }

  const defaultButton = findOne('button.default');
  if (defaultButton) {
    setTimeout(() => defaultButton.focus());
  }

  set({
    cancel: () => b8r.trigger('click', findOne('button.cancel')),
    default: () => b8r.trigger('click', findOne('button.default')),
    button: function(evt) {
      if (data && data.callback) {
        data.callback(evt, component);
      } else {
        console.warn('dialog has no callback; user pressed', evt.target.textContent);
      }
      if (evt.target instanceof HTMLButtonElement) {
        component.remove();
      } else {
        return true;
      }
    },
  });
</script>
