'use strict';function b8r(){}var a;if(a){a.exports=b8r;}b8r.find=b=>b8r.makeArray(document.querySelectorAll(b));b8r.findOne=document.querySelector.bind(document);b8r.findWithin=(f,g,h)=>{var j=b8r.makeArray(f.querySelectorAll(g));if(h&&f.matches('[data-bind]')){j.unshift(f);}return j;};b8r.findOneWithin=(k,l,m)=>m&&k.matches(l)?k:k.querySelector(l);b8r.makeArray=n=>[].slice.apply(n);b8r.succeeding=(o,p)=>{while(o.nextSibling&&!o.nextElementSibling.matches(p)){o=o.nextElementSibling;}return o.nextElementSibling;};b8r.findAbove=(q,u,v)=>{var w=q.parentElement,y=[];while(v&&typeof v==='string'?!w.matches(v):w!==v){if(w.matches(u)){y.push(w);}w=w.parentElement;}return y;};b8r.modifierKeys={meta:'⌘',control:'⌃',alt:'⌥',escape:'⎋',shift:'⇧'};b8r.id=document.getElementById.bind(document);function getByPath(z,A){if(A&&A!=='/'){A=A.split(/\.|\[/);while(A.length&&z){var B=A.shift();if(B.substr(-1)===']'){B=parseInt(B,10);}z=z[B];}}return z;}function setByPath(C,D,E){D=D.split(/\.|\[/);while(D.length>1){var F=D.shift();if(F.substr(-1)===']'){F=parseInt(F,10);}if(!C[F]){C[F]=D[0].substr(-1)===']'?[]:{};}C=C[F];}if(D[0].substr(-1)===']'){C[parseInt(D[0],10)]=E;}else{C[D[0]]=E;}}var G={};b8r.register=function(H,I){if(H.match(/^_[^_]*_$/)){throw"cannot register object as "+H+", all names starting and ending with a single '_' are reserved.";}G[H]=I;if(b8r.getByPath(G[H],'add')){G[H].add();}b8r.find('[data-list*="'+H+'"]').forEach(J=>{bindList(J);b8r.trigger('change',J);});b8r.find('[data-bind*="'+H+'"]').forEach(K=>{bind(K);b8r.trigger('change',K);});playSavedMessages(H);};b8r.isRegistered=function(L){return G[L]!==void 0;};b8r.deregister=function(M){if(b8r.getByPath(G[M],'remove')){G[M].remove();}delete G[M];};b8r.touchByPath=function(N,O,P){if(Array.isArray(b8r.getByPath(N,O))){const Q=b8r.makeArray(document.querySelectorAll('[data-list*="'+N+'.'+O+'"]'));Q.forEach(R=>R!==P&&bindList(R));}else{const S=b8r.makeArray(document.querySelectorAll('[data-bind*="'+N+'.'+O+'"]'));S.forEach(T=>T!==P&&bind(T));}};b8r.setByPath=function(U,V,W,X){if(G[U]){setByPath(G[U],V,W);b8r.touchByPath(U,V,X);}};b8r.getByPath=function(Y,Z){if(Y&&G[Y]){return getByPath(G[Y],Z||'/');}};b8r.getInstance=function(a1){const b1=a1.closest('[data-list-instance]').getAttribute('data-list-instance'),[c1,...d1]=b1.split('.');return b8r.getByPath(c1,d1.join('.'));};function getEventHandlers(e1){const f1=e1.getAttribute('data-event'),g1=f1?f1.replace(/\s*(^|$|[,:;])\s*/g,'$1').split(';'):[];return g1;}function makeHandler(h1,i1,j1){if(typeof h1==='string'){h1=[h1];}if(!Array.isArray(h1)){console.error('makeHandler failed; bad event_type',h1);return;}return h1.sort().join(',')+':'+i1+'.'+j1;}b8r.on=function(k1,l1,m1,n1){if(typeof m1==='object'&&m1.model){return b8r.on(k1,l1,m1.model,m1.method);}if(!(k1 instanceof HTMLElement)){console.error('bind bare elements please, not',k1);return;}if(typeof m1!=='string'||typeof n1!=='string'){console.error('implicit bindings are by name, not',m1,n1);return;}const o1=makeHandler(l1,m1,n1),p1=getEventHandlers(k1);if(p1.indexOf(o1)===-1){p1.push(o1);}if(p1.length){k1.setAttribute('data-event',p1.join(';'));}else{k1.removeAttribute('data-event');}};b8r.off=function(q1,r1,s1,t1){const u1=q1.getAttribute('data-event').split(';'),v1=makeHandler(r1,s1,t1),w1=u1.indexOf(v1);if(w1>-1){u1.splice(w1,1);if(u1.length){q1.setAttribute('data-event',u1.join(';'));}else{q1.removeAttribute('data-event');}}};var x1=null;b8r.onAny=function(y1,z1,A1){if(!x1){x1=b8r.create('div');}b8r.on(x1,y1,z1,A1);};b8r.offAny=function(B1,C1,D1){if(x1){b8r.off(x1,B1,C1,D1);if(!x1.getAttribute('data-event')){x1=null;}}};function implicitEventHandlers(E1){var F1=E1.getAttribute('data-event'),G1=[];if(F1){F1=F1.split(';');G1=F1.map(function(H1){var[I1,J1]=H1.split(':');if(!J1){console.error('missing event handler',H1,'in',E1);return{types:[]};}var[K1,L1]=J1.trim().split('.'),M1=I1.split(',').sort();return{types:M1.map(s=>s.split('(')[0].trim()),type_args:M1.map(s=>{var N1=s.match(/\(([^)]+)\)/);return N1&&N1[1]?N1[1].split(','):!1;}),model:K1,method:L1};});}return G1;}var O1=[];function saveMethodCall(P1,Q1,R1){O1.push({model:P1,method:Q1,evt:R1});}function playSavedMessages(S1){var T1=[];for(var i=O1.length-1;i>=0;i--){if(O1[i].model===S1){T1.push(O1[i]);delete O1[i];}}while(T1.length){var{model,method,evt}=T1.pop();b8r.callMethod(model,method,evt);}}b8r.callMethod=function(U1,V1,W1){var X1=null;if(U1==='_component_'){var Y1,Z1=W1.target.closest('[data-component-uuid]');while(!(Y1&&Y1[V1])&&Z1){var a2=Z1.getAttribute('data-component-uuid');if(G._b8r_components_&&a2){Y1=G._b8r_components_[a2];Z1=Z1.parentElement.closest('[data-component-uuid]');}}if(!Y1){console.error('event bound to _component_ found no view_controller',W1.target);}else{X1=Y1[V1](W1);}}else if(G[U1]){X1=G[U1][V1](W1);}else{saveMethodCall(U1,V1,W1);}return X1;};b8r.trigger=function(b2,c2){if(c2){var stopPropagation=()=>{},preventDefault=()=>{};handleEvent({type:b2,target:c2,stopPropagation,preventDefault});}else{console.warn('b8r.trigger called with no specified target');}};b8r.keystroke=function(d2){var e2=[];if(d2.altKey){e2.push('alt');}if(d2.ctrlKey){e2.push('ctrl');}if(d2.metaKey){e2.push('meta');}if(d2.shiftKey){e2.push('shift');}e2.push(d2.code||'');return e2.join('-');};function handleEvent(f2){var g2=x1?x1:f2.target,h2=b8r.keystroke(f2),i2=!1,j2;while(g2&&!i2){var k2=implicitEventHandlers(g2);for(var i=0;i<k2.length;i++){var l2=k2[i];for(var m2=0;m2<l2.types.length;m2++){if(l2.types[m2]===f2.type&&(!l2.type_args[m2]||l2.type_args[m2].indexOf(h2)>-1)){if(l2.model&&l2.method){j2=b8r.callMethod(l2.model,l2.method,f2);}else{console.error('incomplete event handler on',g2);break;}if(j2!==!0){f2.stopPropagation();f2.preventDefault();i2=!0;break;}}}}g2=g2===x1?f2.target:g2.parentElement;}}var n2=['mousedown','mouseup','mousemove','mouseover','mouseout','click','input','change','keydown','keyup','focus','blur'];if(window.TouchEvent){n2=n2.concat(['touchstart','touchcancel','touchmove','touchend']);}n2.forEach(o2=>document.body.addEventListener(o2,handleEvent,!0));const p2={'_true_':!0,'_false_':!1,'_undefined_':void 0,'_null_':null};var q2={value:function(r2,s2){switch(r2.getAttribute('type')){case'radio':r2.checked=r2.value===s2;break;case'checkbox':r2.checked=s2;break;default:r2.value=s2;}},checked:function(t2,u2){t2.checked=!!u2;},text:function(v2,w2){v2.textContent=w2;},attr:function(x2,y2,z2){if(y2===void 0||y2===null){x2.removeAttribute(z2);}else{x2.setAttribute(z2,y2);}},style:function(A2,B2,C2){if(!C2){if(typeof B2==='string'){A2.setAttribute('style',C2);}else if(typeof B2==='object'){Object.assign(A2.style,B2);}}else if(B2!==void 0){A2.style[C2]=B2;}},class:function(D2,E2,F2){if(F2){if(E2){D2.classList.add(F2);}else{D2.classList.remove(F2);}}else{D2.setAttribute('class',E2);}},enabled_if:function(G2,H2,I2){const J2=p2.hasOwnProperty(I2)?x=>x==p2[I2]:x=>!!x;G2.disabled=J2(H2);},enabled_unless:function(K2,L2,M2){const N2=p2.hasOwnProperty(M2)?x=>x==p2[M2]:x=>!!x;K2.disabled=N2(L2);},show_if:function(O2,P2,Q2){if(Q2!==void 0?P2==Q2:P2!==void 0){b8r.show(O2);}else{b8r.hide(O2);}},method:function(R2,S2,T2,U2){var[V2,W2]=T2.split('.');b8r.getByPath(V2,W2)(R2,S2,U2);},json:function(X2,Y2){X2.textContent=JSON.stringify(Y2,!1,2);},component_map:function(Z2,a3,b3,c3){if(Z2.getAttribute('data-component-uuid')){return;}var d3=b3.split('|'),e3;for(var i=0;i<d3.length;i++){var f3=d3[i].split(':');if(f3.length===1||f3[0]==a3){e3=f3.pop();break;}}if(e3){b8r.insertComponent(e3,Z2,c3);}}},g3={value:function(h3){return h3.value;},checked:function(i3){return i3.checked;},text:function(j3){return j3.textContent;}};function parseBinding(k3){var[l3,m3]=k3.split('=');l3=l3.split(',').map(function(n3){var o3=n3.match(/(\w+)(\(([^)]+)\))?/);if(!o3){console.error('bad target',n3,'in binding',k3);return;}return o3?{target:o3[1],key:o3[3]}:null;});if(!m3){console.error('binding does not specify source',k3);}var[,p3,,q3]=m3.match(/([^.;]*)(\.(.+))?/);return{targets:l3,model:p3,path:q3};}function getBindings(r3){return r3.getAttribute('data-bind').split(';').filter(s=>!!s).map(parseBinding);}function buildTargets(s3){return s3.targets.map(t3=>t3.target+(t3.key?'('+t3.key+')':''));}function addBasePathToBindings(u3,v3,w3){if(w3){u3.setAttribute('data-bind',v3.map(x3=>buildTargets(x3)+'='+w3+'.'+x3.model+x3.path).join(';'));}}function findBindables(y3){return b8r.findWithin(y3,'[data-bind]',!0).filter(z3=>{var A3=z3.closest('[data-list]');return!A3||A3===y3||!y3.contains(A3);});}function bind(B3,C3,D3){var E3=getBindings(B3);addBasePathToBindings(B3,E3,D3);for(var i=0;i<E3.length;i++){var{targets,model,path}=E3[i],F3=C3||G[model],G3=targets.filter(t=>q2[t.target]),H3=targets.filter(t=>g3[t.target]);if(F3&&G3.length){G3.forEach(t=>{q2[t.target](B3,getByPath(F3,path),t.key,F3);});}if(H3.length){b8r.on(B3,['change','input'],'_b8r_','update');}}}function findLists(I3){return b8r.findWithin(I3,'[data-list]').filter(J3=>{var K3=J3.parentElement.closest('[data-list]');return!K3||K3===I3||!I3.contains(K3);});}b8r.hide=function(L3){if(L3.getAttribute('data-orig-display')!==null&&L3.style.display&&L3.style.display!=='none'){L3.setAttribute('data-orig-display',L3.style.display);b8r.findWithin(L3,'[data-event*="hide"]').forEach(M3=>b8r.trigger('hide',M3));}L3.style.display='none';};b8r.show=function(N3){if(N3.style.display==='none'){N3.style.display=N3.getAttribute('data-orig-display')||'';b8r.findWithin(N3,'[data-event*="show"]').forEach(O3=>b8r.trigger('show',O3));}};function bindList(P3,Q3,R3){var[S3]=P3.getAttribute('data-list').split(':'),T3,U3;try{[,T3,,U3]=S3.match(/^([^\.]*)(\.(.*))?$/);}catch(e){console.error('bindList failed',S3,e);}if(T3===''&&!Q3&&!R3){return;}var V3=Q3?getByPath(Q3,U3):b8r.getByPath(T3,U3);if(!V3||!V3.length){return;}while(P3.previousSibling&&(!P3.previousSibling.matches||P3.previousSibling.matches('[data-list-instance]'))){P3.parentElement.removeChild(P3.previousSibling);}b8r.show(P3);for(var i=0;i<V3.length;i++){var W3=P3.cloneNode(!0);W3.removeAttribute('data-list');const X3=S3+'['+i+']';W3.setAttribute('data-list-instance',X3);bindAll(W3,V3[i],X3);P3.parentElement.insertBefore(W3,P3);}b8r.hide(P3);}function bindAll(Y3,Z3,a4){loadAvailableComponents(Y3,Z3);findBindables(Y3).forEach(b4=>bind(b4,Z3,a4));findLists(Y3).forEach(c4=>bindList(c4,Z3,a4));b8r.trigger('change',Y3);}b8r.bindAll=bindAll;G._b8r_={stopEvent:()=>{},update:function(d4){var e4=getBindings(d4.target);for(var i=0;i<e4.length;i++){var{targets,model,path}=e4[i];targets=targets.filter(t=>g3[t.target]);targets.forEach(t=>{b8r.setByPath(model,path,g3[t.target](d4.target,t.key),d4.target);});}return!0;}};b8r.ajax=function(f4,g4,h4,i4){return new Promise(function(j4,k4){i4=i4||{};if(!i4.headers){i4.headers=[];}var l4=new XMLHttpRequest();l4.open(g4||'GET',f4,!0);l4.onreadystatechange=()=>{if(l4.readyState===XMLHttpRequest.DONE){switch(Math.floor(l4.status/100)){case 0:case 5:case 4:k4(l4);break;case 3:break;case 2:j4(l4.responseText);break;}}};if(typeof h4==='object'){h4=JSON.stringify(h4);i4.headers.push({prop:'Content-Type',value:'application/json; charset=utf-8'});}i4.headers.forEach(m4=>l4.setRequestHeader(m4.prop,m4.value));l4.send(h4);});};b8r.json=function(n4,o4,p4,q4){return new Promise(function(r4,s4){b8r.ajax(n4,o4,p4,q4).then(t4=>{try{r4(JSON.parse(t4||'null'));}catch(e){console.error('Failed to parse data',t4,e);}},s4);});};b8r.jsonp=function(u4,v4,w4,x4){return new Promise(function(y4,z4){b8r.ajax(u4,v4,w4,x4).then(A4=>{try{y4(JSON.parse(A4||'null'));}catch(e){console.error('Failed to parse data',A4,e);}},z4);});};var B4={};b8r.text=document.createTextNode.bind(document);b8r.fragment=document.createDocumentFragment.bind(document);b8r.create=document.createElement.bind(document);b8r.empty=function(C4){while(C4.lastChild){C4.removeChild(C4.lastChild);}};b8r.moveChildren=function(D4,E4){while(D4.firstChild){E4.appendChild(D4.firstChild);}};b8r.copyChildren=function(F4,G4){var H4=F4.firstChild;while(H4){G4.appendChild(H4.cloneNode(!0));H4=H4.nextSibling;}};b8r.component=function(I4,J4){return new Promise(function(K4,L4){if(B4[I4]){K4(B4[I4]);}else{b8r.ajax(J4+'.component.html').then(M4=>{K4(b8r.makeComponent(I4,M4));},N4=>L4(N4));}});};b8r.makeComponent=function(O4,P4){var Q4=!1,R4,S4=!1,T4,U4;T4=P4.split(/<style>|<\/style>/);if(T4.length===3){[,Q4,U4]=T4;}else{U4=P4;}T4=U4.split(/<script>|<\/script>/);if(T4.length===3){[R4,S4]=T4;}else{R4=U4;}var V4=b8r.create('div');V4.innerHTML=R4;var W4=S4?new Function('component','b8r','find','findOne','data',S4):!1,X4;if(Q4){X4=b8r.create('style');X4.type='text/css';X4.appendChild(b8r.text(Q4));document.head.appendChild(X4);}var Y4={name:O4,style:Q4?X4:!1,view:V4,load:W4,_source:P4};B4[O4]=Y4;var Z4=b8r.find('[data-component="'+O4+'"]');Z4.forEach(a5=>b8r.insertComponent(Y4,a5));return Y4;};var b5=[];function saveDataForElement(c5,d5){if(d5){removeDataForElement(c5);b5.push({target_element:c5,data:d5});}}function dataForElement(e5){for(var i=0;i<b5.length;i++){if(b5[i].target_element===e5){return b5[i].data;}}return null;}function removeDataForElement(f5){for(var i=0;i<b5.length;i++){if(b5[i].target_element===f5){delete b5[i].data;}}}function loadAvailableComponents(g5,h5){b8r.findWithin(g5||document.body,'[data-component]').forEach(i5=>{if(!i5.matches('[data-component-uuid]')){var j5=i5.getAttribute('data-component');b8r.insertComponent(j5,i5,h5);}});}b8r.insertComponent=function(k5,l5,m5){if(typeof k5==='string'){if(!B4[k5]){console.warn('component not available: ',name);if(m5){saveDataForElement(l5,m5);}return;}k5=B4[k5];}if(!m5){m5=dataForElement(l5,k5.name);}removeDataForElement(l5);if(!l5){l5=b8r.create('div');document.body.appendChild(l5);}var n5=b8r.fragment();b8r.moveChildren(l5,n5);b8r.copyChildren(k5.view,l5);var o5=b8r.findOneWithin(l5,'[data-children]');if(n5.firstChild&&o5){b8r.empty(o5);b8r.moveChildren(n5,o5);}var p5=b8r.uuid();l5.setAttribute('data-component-uuid',p5);bindAll(l5,m5);if(k5.load){var q5=k5.load(l5,b8r,r5=>b8r.findWithin(l5,r5),s5=>b8r.findOneWithin(l5,s5),m5);if(q5){if(!G._b8r_components_){G._b8r_components_={};}q5.root_element=l5;G._b8r_components_[p5]=q5;}}return l5;};b8r.uuid=function(){var d=new Date().getTime();if(window.performance&&typeof window.performance.now==="function"){d+=performance.now();}return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:r&0x3|0x8).toString(16);});};

